require 'rake/clean'


file 'js/gen/deps.js' => FileList['js/lib/*.js'] do |t|
    sh "closure --warning_level QUIET --js_output_file js/gen/deps.js --js #{t.prerequisites.join(' --js ')}"
end
task :default => 'js/gen/deps.js'
CLOBBER.include 'js/gen/deps.js'


FileList['coffee/*.coffee'].each do |src|
    target = File.join('js/gen', src.pathmap('%n.js'))
    file target => src do |t|
        sh "coffee -o #{File.dirname(t.name)} -c #{src}"
    end
    CLOBBER.include(target)
    task :default => target
end
        

FileList['sass/*.scss'].each do |src|
  target = File.join('stylesheets', src.pathmap('%n.css'))
  file target => src do
    sh "compass compile . #{src}"
  end
  
  CLOBBER.include(target)
  task :default => target
end
